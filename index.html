<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AR GPS Direction Arrow</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: black;
  font-family: Arial, sans-serif;
}

/* CAMERA */
video {
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 0;
}

/* ARROW */
#arrow {
  position: fixed;
  left: 50%;
  top: 40%;
  width: 160px;
  height: auto;
  transform-origin: 50% 90%;
  z-index: 2;

  filter: drop-shadow(0 18px 25px rgba(0,0,0,0.7));
}

/* INFO */
#info {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.6);
  color: white;
  padding: 10px 16px;
  border-radius: 12px;
  z-index: 3;
  font-size: 16px;
}
</style>
</head>

<body>

<video id="camera" autoplay playsinline></video>
<img id="arrow" src="arrow.svg" alt="direction arrow">
<div id="info">Initializingâ€¦</div>

<script>
/* =========================
   TARGET LOCATION (YOURS)
   ========================= */
const targetLat = 11.0245585;
const targetLon = 124.0111658;

/* =========================
   CAMERA
   ========================= */
navigator.mediaDevices.getUserMedia({
  video: { facingMode: { ideal: "environment" } }
})
.then(stream => {
  document.getElementById("camera").srcObject = stream;
})
.catch(() => alert("Camera access required"));

/* =========================
   GPS + COMPASS
   ========================= */
let currentLat = null;
let currentLon = null;
let heading = 0;

navigator.geolocation.watchPosition(
  pos => {
    currentLat = pos.coords.latitude;
    currentLon = pos.coords.longitude;
  },
  err => alert("Enable GPS"),
  { enableHighAccuracy: true, maximumAge: 0 }
);

window.addEventListener("deviceorientationabsolute", e => {
  if (e.alpha !== null) heading = e.alpha;
});

/* =========================
   MATH
   ========================= */
function toRad(d) { return d * Math.PI / 180; }
function toDeg(r) { return r * 180 / Math.PI; }

function bearing(lat1, lon1, lat2, lon2) {
  const y = Math.sin(toRad(lon2 - lon1)) * Math.cos(toRad(lat2));
  const x =
    Math.cos(toRad(lat1)) * Math.sin(toRad(lat2)) -
    Math.sin(toRad(lat1)) * Math.cos(toRad(lat2)) *
    Math.cos(toRad(lon2 - lon1));
  return (toDeg(Math.atan2(y, x)) + 360) % 360;
}

function distance(lat1, lon1, lat2, lon2) {
  const R = 6371000;
  const dLat = toRad(lat2 - lat1);
  const dLon = toRad(lon2 - lon1);
  const a =
    Math.sin(dLat / 2) ** 2 +
    Math.cos(toRad(lat1)) *
    Math.cos(toRad(lat2)) *
    Math.sin(dLon / 2) ** 2;
  return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
}

/* =========================
   UPDATE LOOP
   ========================= */
setInterval(() => {
  if (currentLat === null || heading === null) return;

  const brg = bearing(currentLat, currentLon, targetLat, targetLon);
  const rot = brg - heading;

  document.getElementById("arrow").style.transform =
    `translateX(-50%) rotate(${rot}deg)`;

  const dist = Math.round(
    distance(currentLat, currentLon, targetLat, targetLon)
  );

  document.getElementById("info").innerText =
    `Distance: ${dist} meters`;

}, 600);
</script>

</body>
</html>
